%
% A matrix corresponding to a piece of "the cat"
%

Acat = [100 103 99 97 93 94 78 73;
 102 97 100 111 113 104 96 82;
 99 109 104 95 93 92 88 76;
 114 104 99 102 93 82 74 74;
 96 91 91 87 79 78 77 76;
 90 88 83 78 77 74 76 76;
 92 81 73 72 69 65 66 62;
 75 70 69 65 60 55 61 65]

% C = haar2Dv1_n(Acat);  to compute the normalized Harr coeffs
% Zcatn1 = round(C);

Zcatn1 = [682    52    15    21     6     3     8     8;
    78     6    -8    22    -5    -4     2     8;
     8   -14    -8     7     1    -5    -1     2;
    38    -1    -3     2    -3     1    -2     0;
   -17    12     7    -1    -4     6    -5    -5;
     4   -10    -3    -2   -10     6    -5     6;
     8     5    -3     2     1     0    -1     0;
    15     5     6     6     3    -1     0     4]

% Zcatn2 is obtained by dropping the coefficents of absolute value < 10

Zcatn = zeros(8,8);
Zcatn(1,1) = 255;
Zcatn(1,2) = 52;
Zcatn(1,3) = 15;
Zcatn(1,4) = 21;
Zcatn(2,1) = 78;
Zcatn(2,4) = 22;
Zcatn(4,1) = 38;
Zcatn(5,2) = 11;
Zcatn(8,1) = 15

Zcatn2 = Zcatn;
Zcatn2(1,1) = 682;
Zcatn2(5,1) = -17;
Zcatn2(3,2) = -14;
Zcatn2(6,2) = -10;
Zcatn2(6,5) = -10;
Zcatn2(5,2) = 12

Zcatn2 = [682    52    15    21     0     0     0     0;
    78     0     0    22     0     0     0     0;
     0   -14     0     0     0     0     0     0;
    38     0     0     0     0     0     0     0;
   -17    12     0     0     0     0     0     0;
     0   -10     0     0   -10     0     0     0;
     0     0     0     0     0     0     0     0;
    15     0     0     0     0     0     0     0]

% ZZ = haar_inv2Dv1_n(Zcatn2); to reconstruct the Acat matrix (compressed)
% Acat2 = round(ZZ)

Acat2 =[100   100    95    95    91    91    76    76;
   103   103    98    98   106   106    91    91;
    99   109    99    99    96    96    81    81;
   114   104   104   104    91    91    76    76;
    91    91    86    86    76    76    76    76;
    91    91    86    86    76    76    76    76;
    82    82    76    76    66    66    66    66;
    74    74    69    69    58    58    59    59] 

T = [1212 -306 -146 -54 -24 -68 -40 4;
    30 36 -90 -2 8 -20 8 -4;
    -50 -10 -20 -24 0 72 -16 -16;
    82 38 -24 68 48 -64 32 8;
    8 8 -32 16 -48 -48 -16 16;
    20 20 -56 -16 -16 32 -16 -16;
    -8 8 -48 0 -16 -16 -16 -16;
    44 36 0 8 80 -16 -16 0]

% P = haar_inv2D(T);

P = [576         704        1152        1280        1344        1472        1536        1536;
     704         640        1152        1088        1344        1408        1536        1600;
     768         832        1216        1472        1472        1536        1600        1600;
     832         832         960        1344        1536        1536        1600        1536;
     832         832         960        1216        1536        1600        1536        1536;
     960         896         896        1088        1600        1600        1600        1536;
     768         768         832         832        1280        1472        1600        1600;
     448         768         704         640        1280        1408        1600        1600]
 
 % wrong matrix P in Example 4.1 of Ames
 
 Pbad = [576         704        1152        1280        1344        1472        1536        1536;
     704         640        1156        1088        1344        1408        1536        1600;
     768         832        1216        1472        1472        1536        1600        1600;
     832         832         960        1344        1536        1536        1600        1536;
     832         832         960        1216        1536        1600        1536        1536;
     960         896         896        1088        1600        1600        1600        1536;
     768         768         832         832        1280        1472        1600        1600;
     448         768         704         640        1280        1408        1600        1600]
     
% wrong entry Pbad(2, 3) = 1156 instead of 1152


u = [0 2 4 6 6 4 2 1 -1 -2 -4 -6 -6 -4 -2 0]